version: '3.9'
services:
  api:
    build:
      context: ..
      dockerfile: apps/api/Dockerfile
    environment:
      DATABASE_URL: file:./.data/dev.db
      JWT_SECRET: change-me-in-real-env
      PORT: 3000
    ports:
      - '3000:3000'
    volumes:
      - api-data:/workspace/apps/api/.data

  engine:
    build:
      context: ..
      dockerfile: services/engine-cpp/Dockerfile
    entrypoint: ["/bin/sh", "-lc", "sleep infinity"]

volumes:
  api-data:
